"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/three-render-objects@1.29.4_three@0.167.1";
exports.ids = ["vendor-chunks/three-render-objects@1.29.4_three@0.167.1"];
exports.modules = {

/***/ "(ssr)/./node_modules/.pnpm/three-render-objects@1.29.4_three@0.167.1/node_modules/three-render-objects/dist/three-render-objects.mjs":
/*!**************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/three-render-objects@1.29.4_three@0.167.1/node_modules/three-render-objects/dist/three-render-objects.mjs ***!
  \**************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ threeRenderObjects)\n/* harmony export */ });\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! three */ \"(ssr)/./node_modules/.pnpm/three@0.167.1/node_modules/three/build/three.module.js\");\n/* harmony import */ var three_examples_jsm_controls_TrackballControls_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! three/examples/jsm/controls/TrackballControls.js */ \"(ssr)/./node_modules/.pnpm/three@0.167.1/node_modules/three/examples/jsm/controls/TrackballControls.js\");\n/* harmony import */ var three_examples_jsm_controls_OrbitControls_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! three/examples/jsm/controls/OrbitControls.js */ \"(ssr)/./node_modules/.pnpm/three@0.167.1/node_modules/three/examples/jsm/controls/OrbitControls.js\");\n/* harmony import */ var three_examples_jsm_controls_FlyControls_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! three/examples/jsm/controls/FlyControls.js */ \"(ssr)/./node_modules/.pnpm/three@0.167.1/node_modules/three/examples/jsm/controls/FlyControls.js\");\n/* harmony import */ var three_examples_jsm_postprocessing_EffectComposer_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! three/examples/jsm/postprocessing/EffectComposer.js */ \"(ssr)/./node_modules/.pnpm/three@0.167.1/node_modules/three/examples/jsm/postprocessing/EffectComposer.js\");\n/* harmony import */ var three_examples_jsm_postprocessing_RenderPass_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! three/examples/jsm/postprocessing/RenderPass.js */ \"(ssr)/./node_modules/.pnpm/three@0.167.1/node_modules/three/examples/jsm/postprocessing/RenderPass.js\");\n/* harmony import */ var polished__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! polished */ \"(ssr)/./node_modules/.pnpm/polished@4.3.1/node_modules/polished/dist/polished.esm.js\");\n/* harmony import */ var _tweenjs_tween_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @tweenjs/tween.js */ \"(ssr)/./node_modules/.pnpm/@tweenjs+tween.js@23.1.3/node_modules/@tweenjs/tween.js/dist/tween.esm.js\");\n/* harmony import */ var accessor_fn__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! accessor-fn */ \"(ssr)/./node_modules/.pnpm/accessor-fn@1.5.1/node_modules/accessor-fn/dist/accessor-fn.mjs\");\n/* harmony import */ var kapsule__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kapsule */ \"(ssr)/./node_modules/.pnpm/kapsule@1.14.5/node_modules/kapsule/dist/kapsule.mjs\");\n\n\n\n\n\n\n\n\n\n\n\nfunction styleInject(css, ref) {\n  ref = {};\n  ref.insertAt;\n  if (typeof document === 'undefined') {\n    return;\n  }\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n  {\n    head.appendChild(style);\n  }\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css_248z = \".scene-nav-info {\\n  bottom: 5px;\\n  width: 100%;\\n  text-align: center;\\n  color: slategrey;\\n  opacity: 0.7;\\n  font-size: 10px;\\n}\\n\\n.scene-tooltip {\\n  top: 0;\\n  color: lavender;\\n  font-size: 15px;\\n}\\n\\n.scene-nav-info, .scene-tooltip {\\n  position: absolute;\\n  font-family: sans-serif;\\n  pointer-events: none;\\n  user-select: none;\\n}\\n\\n.scene-container canvas:focus {\\n  outline: none;\\n}\";\nstyleInject(css_248z);\n\nfunction _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) ; else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t.return && (u = t.return(), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}\nfunction _toPrimitive(t, r) {\n  if (\"object\" != typeof t || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r );\n    if (\"object\" != typeof i) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (String )(t);\n}\nfunction _toPropertyKey(t) {\n  var i = _toPrimitive(t, \"string\");\n  return \"symbol\" == typeof i ? i : i + \"\";\n}\nfunction _defineProperty(obj, key, value) {\n  key = _toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar three = window.THREE ? window.THREE // Prefer consumption from global THREE, if exists\n: {\n  WebGLRenderer: three__WEBPACK_IMPORTED_MODULE_2__.WebGLRenderer,\n  Scene: three__WEBPACK_IMPORTED_MODULE_2__.Scene,\n  PerspectiveCamera: three__WEBPACK_IMPORTED_MODULE_2__.PerspectiveCamera,\n  Raycaster: three__WEBPACK_IMPORTED_MODULE_2__.Raycaster,\n  SRGBColorSpace: three__WEBPACK_IMPORTED_MODULE_2__.SRGBColorSpace,\n  TextureLoader: three__WEBPACK_IMPORTED_MODULE_2__.TextureLoader,\n  Vector2: three__WEBPACK_IMPORTED_MODULE_2__.Vector2,\n  Vector3: three__WEBPACK_IMPORTED_MODULE_2__.Vector3,\n  Box3: three__WEBPACK_IMPORTED_MODULE_2__.Box3,\n  Color: three__WEBPACK_IMPORTED_MODULE_2__.Color,\n  Mesh: three__WEBPACK_IMPORTED_MODULE_2__.Mesh,\n  SphereGeometry: three__WEBPACK_IMPORTED_MODULE_2__.SphereGeometry,\n  MeshBasicMaterial: three__WEBPACK_IMPORTED_MODULE_2__.MeshBasicMaterial,\n  BackSide: three__WEBPACK_IMPORTED_MODULE_2__.BackSide,\n  EventDispatcher: three__WEBPACK_IMPORTED_MODULE_2__.EventDispatcher,\n  MOUSE: three__WEBPACK_IMPORTED_MODULE_2__.MOUSE,\n  Quaternion: three__WEBPACK_IMPORTED_MODULE_2__.Quaternion,\n  Spherical: three__WEBPACK_IMPORTED_MODULE_2__.Spherical,\n  Clock: three__WEBPACK_IMPORTED_MODULE_2__.Clock\n};\nvar threeRenderObjects = (0,kapsule__WEBPACK_IMPORTED_MODULE_3__[\"default\"])({\n  props: {\n    width: {\n      \"default\": window.innerWidth,\n      onChange: function onChange(width, state, prevWidth) {\n        isNaN(width) && (state.width = prevWidth);\n      }\n    },\n    height: {\n      \"default\": window.innerHeight,\n      onChange: function onChange(height, state, prevHeight) {\n        isNaN(height) && (state.height = prevHeight);\n      }\n    },\n    backgroundColor: {\n      \"default\": '#000011'\n    },\n    backgroundImageUrl: {},\n    onBackgroundImageLoaded: {},\n    showNavInfo: {\n      \"default\": true\n    },\n    skyRadius: {\n      \"default\": 50000\n    },\n    objects: {\n      \"default\": []\n    },\n    lights: {\n      \"default\": []\n    },\n    enablePointerInteraction: {\n      \"default\": true,\n      onChange: function onChange(_, state) {\n        // Reset hover state\n        state.hoverObj = null;\n        if (state.toolTipElem) state.toolTipElem.innerHTML = '';\n      },\n      triggerUpdate: false\n    },\n    lineHoverPrecision: {\n      \"default\": 1,\n      triggerUpdate: false\n    },\n    hoverOrderComparator: {\n      \"default\": function _default() {\n        return -1;\n      },\n      triggerUpdate: false\n    },\n    // keep existing order by default\n    hoverFilter: {\n      \"default\": function _default() {\n        return true;\n      },\n      triggerUpdate: false\n    },\n    // exclude objects from interaction\n    tooltipContent: {\n      triggerUpdate: false\n    },\n    hoverDuringDrag: {\n      \"default\": false,\n      triggerUpdate: false\n    },\n    clickAfterDrag: {\n      \"default\": false,\n      triggerUpdate: false\n    },\n    onHover: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onClick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onRightClick: {\n      triggerUpdate: false\n    }\n  },\n  methods: {\n    tick: function tick(state) {\n      if (state.initialised) {\n        state.controls.update && state.controls.update(Math.min(1, state.clock.getDelta())); // timedelta is required for fly controls\n\n        state.postProcessingComposer ? state.postProcessingComposer.render() // if using postprocessing, switch the output to it\n        : state.renderer.render(state.scene, state.camera);\n        state.extraRenderers.forEach(function (r) {\n          return r.render(state.scene, state.camera);\n        });\n        if (state.enablePointerInteraction) {\n          // Update tooltip and trigger onHover events\n          var topObject = null;\n          if (state.hoverDuringDrag || !state.isPointerDragging) {\n            var intersects = this.intersectingObjects(state.pointerPos.x, state.pointerPos.y).filter(function (d) {\n              return state.hoverFilter(d.object);\n            }).sort(function (a, b) {\n              return state.hoverOrderComparator(a.object, b.object);\n            });\n            var topIntersect = intersects.length ? intersects[0] : null;\n            topObject = topIntersect ? topIntersect.object : null;\n            state.intersectionPoint = topIntersect ? topIntersect.point : null;\n          }\n          if (topObject !== state.hoverObj) {\n            state.onHover(topObject, state.hoverObj);\n            state.toolTipElem.innerHTML = topObject ? (0,accessor_fn__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(state.tooltipContent)(topObject) || '' : '';\n            state.hoverObj = topObject;\n          }\n        }\n        _tweenjs_tween_js__WEBPACK_IMPORTED_MODULE_0__.update(); // update camera animation tweens\n      }\n      return this;\n    },\n    getPointerPos: function getPointerPos(state) {\n      var _state$pointerPos = state.pointerPos,\n        x = _state$pointerPos.x,\n        y = _state$pointerPos.y;\n      return {\n        x: x,\n        y: y\n      };\n    },\n    cameraPosition: function cameraPosition(state, position, lookAt, transitionDuration) {\n      var camera = state.camera;\n\n      // Setter\n      if (position && state.initialised) {\n        var finalPos = position;\n        var finalLookAt = lookAt || {\n          x: 0,\n          y: 0,\n          z: 0\n        };\n        if (!transitionDuration) {\n          // no animation\n          setCameraPos(finalPos);\n          setLookAt(finalLookAt);\n        } else {\n          var camPos = Object.assign({}, camera.position);\n          var camLookAt = getLookAt();\n          new _tweenjs_tween_js__WEBPACK_IMPORTED_MODULE_0__.Tween(camPos).to(finalPos, transitionDuration).easing(_tweenjs_tween_js__WEBPACK_IMPORTED_MODULE_0__.Easing.Quadratic.Out).onUpdate(setCameraPos).start();\n\n          // Face direction in 1/3rd of time\n          new _tweenjs_tween_js__WEBPACK_IMPORTED_MODULE_0__.Tween(camLookAt).to(finalLookAt, transitionDuration / 3).easing(_tweenjs_tween_js__WEBPACK_IMPORTED_MODULE_0__.Easing.Quadratic.Out).onUpdate(setLookAt).start();\n        }\n        return this;\n      }\n\n      // Getter\n      return Object.assign({}, camera.position, {\n        lookAt: getLookAt()\n      });\n\n      //\n\n      function setCameraPos(pos) {\n        var x = pos.x,\n          y = pos.y,\n          z = pos.z;\n        if (x !== undefined) camera.position.x = x;\n        if (y !== undefined) camera.position.y = y;\n        if (z !== undefined) camera.position.z = z;\n      }\n      function setLookAt(lookAt) {\n        var lookAtVect = new three.Vector3(lookAt.x, lookAt.y, lookAt.z);\n        if (state.controls.target) {\n          state.controls.target = lookAtVect;\n        } else {\n          // Fly controls doesn't have target attribute\n          camera.lookAt(lookAtVect); // note: lookAt may be overridden by other controls in some cases\n        }\n      }\n      function getLookAt() {\n        return Object.assign(new three.Vector3(0, 0, -1000).applyQuaternion(camera.quaternion).add(camera.position));\n      }\n    },\n    zoomToFit: function zoomToFit(state) {\n      var transitionDuration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var padding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 10;\n      for (var _len = arguments.length, bboxArgs = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n        bboxArgs[_key - 3] = arguments[_key];\n      }\n      return this.fitToBbox(this.getBbox.apply(this, bboxArgs), transitionDuration, padding);\n    },\n    fitToBbox: function fitToBbox(state, bbox) {\n      var transitionDuration = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var padding = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 10;\n      // based on https://discourse.threejs.org/t/camera-zoom-to-fit-object/936/24\n      var camera = state.camera;\n      if (bbox) {\n        var center = new three.Vector3(0, 0, 0); // reset camera aim to center\n        var maxBoxSide = Math.max.apply(Math, _toConsumableArray(Object.entries(bbox).map(function (_ref) {\n          var _ref2 = _slicedToArray(_ref, 2),\n            coordType = _ref2[0],\n            coords = _ref2[1];\n          return Math.max.apply(Math, _toConsumableArray(coords.map(function (c) {\n            return Math.abs(center[coordType] - c);\n          })));\n        }))) * 2;\n\n        // find distance that fits whole bbox within padded fov\n        var paddedFov = (1 - padding * 2 / state.height) * camera.fov;\n        var fitHeightDistance = maxBoxSide / Math.atan(paddedFov * Math.PI / 180);\n        var fitWidthDistance = fitHeightDistance / camera.aspect;\n        var distance = Math.max(fitHeightDistance, fitWidthDistance);\n        if (distance > 0) {\n          var newCameraPosition = center.clone().sub(camera.position).normalize().multiplyScalar(-distance);\n          this.cameraPosition(newCameraPosition, center, transitionDuration);\n        }\n      }\n      return this;\n    },\n    getBbox: function getBbox(state) {\n      var objFilter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {\n        return true;\n      };\n      var box = new three.Box3(new three.Vector3(0, 0, 0), new three.Vector3(0, 0, 0));\n      var objs = state.objects.filter(objFilter);\n      if (!objs.length) return null;\n      objs.forEach(function (obj) {\n        return box.expandByObject(obj);\n      });\n\n      // extract global x,y,z min/max\n      return Object.assign.apply(Object, _toConsumableArray(['x', 'y', 'z'].map(function (c) {\n        return _defineProperty({}, c, [box.min[c], box.max[c]]);\n      })));\n    },\n    getScreenCoords: function getScreenCoords(state, x, y, z) {\n      var vec = new three.Vector3(x, y, z);\n      vec.project(this.camera()); // project to the camera plane\n      return {\n        // align relative pos to canvas dimensions\n        x: (vec.x + 1) * state.width / 2,\n        y: -(vec.y - 1) * state.height / 2\n      };\n    },\n    getSceneCoords: function getSceneCoords(state, screenX, screenY) {\n      var distance = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      var relCoords = new three.Vector2(screenX / state.width * 2 - 1, -(screenY / state.height) * 2 + 1);\n      var raycaster = new three.Raycaster();\n      raycaster.setFromCamera(relCoords, state.camera);\n      return Object.assign({}, raycaster.ray.at(distance, new three.Vector3()));\n    },\n    intersectingObjects: function intersectingObjects(state, x, y) {\n      var relCoords = new three.Vector2(x / state.width * 2 - 1, -(y / state.height) * 2 + 1);\n      var raycaster = new three.Raycaster();\n      raycaster.params.Line.threshold = state.lineHoverPrecision; // set linePrecision\n      raycaster.setFromCamera(relCoords, state.camera);\n      return raycaster.intersectObjects(state.objects, true);\n    },\n    renderer: function renderer(state) {\n      return state.renderer;\n    },\n    scene: function scene(state) {\n      return state.scene;\n    },\n    camera: function camera(state) {\n      return state.camera;\n    },\n    postProcessingComposer: function postProcessingComposer(state) {\n      return state.postProcessingComposer;\n    },\n    controls: function controls(state) {\n      return state.controls;\n    },\n    tbControls: function tbControls(state) {\n      return state.controls;\n    } // to be deprecated\n  },\n  stateInit: function stateInit() {\n    return {\n      scene: new three.Scene(),\n      camera: new three.PerspectiveCamera(),\n      clock: new three.Clock()\n    };\n  },\n  init: function init(domNode, state) {\n    var _ref4 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n      _ref4$controlType = _ref4.controlType,\n      controlType = _ref4$controlType === void 0 ? 'trackball' : _ref4$controlType,\n      _ref4$rendererConfig = _ref4.rendererConfig,\n      rendererConfig = _ref4$rendererConfig === void 0 ? {} : _ref4$rendererConfig,\n      _ref4$extraRenderers = _ref4.extraRenderers,\n      extraRenderers = _ref4$extraRenderers === void 0 ? [] : _ref4$extraRenderers,\n      _ref4$waitForLoadComp = _ref4.waitForLoadComplete,\n      waitForLoadComplete = _ref4$waitForLoadComp === void 0 ? true : _ref4$waitForLoadComp;\n    // Wipe DOM\n    domNode.innerHTML = '';\n\n    // Add relative container\n    domNode.appendChild(state.container = document.createElement('div'));\n    state.container.className = 'scene-container';\n    state.container.style.position = 'relative';\n\n    // Add nav info section\n    state.container.appendChild(state.navInfo = document.createElement('div'));\n    state.navInfo.className = 'scene-nav-info';\n    state.navInfo.textContent = {\n      orbit: 'Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan',\n      trackball: 'Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan',\n      fly: 'WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw'\n    }[controlType] || '';\n    state.navInfo.style.display = state.showNavInfo ? null : 'none';\n\n    // Setup tooltip\n    state.toolTipElem = document.createElement('div');\n    state.toolTipElem.classList.add('scene-tooltip');\n    state.container.appendChild(state.toolTipElem);\n\n    // Capture pointer coords on move or touchstart\n    state.pointerPos = new three.Vector2();\n    state.pointerPos.x = -2; // Initialize off canvas\n    state.pointerPos.y = -2;\n    ['pointermove', 'pointerdown'].forEach(function (evType) {\n      return state.container.addEventListener(evType, function (ev) {\n        // track click state\n        evType === 'pointerdown' && (state.isPointerPressed = true);\n\n        // detect point drag\n        !state.isPointerDragging && ev.type === 'pointermove' && (ev.pressure > 0 || state.isPointerPressed) // ev.pressure always 0 on Safari, so we used the isPointerPressed tracker\n        && (ev.pointerType !== 'touch' || ev.movementX === undefined || [ev.movementX, ev.movementY].some(function (m) {\n          return Math.abs(m) > 1;\n        })) // relax drag trigger sensitivity on touch events\n        && (state.isPointerDragging = true);\n        if (state.enablePointerInteraction) {\n          // update the pointer pos\n          var offset = getOffset(state.container);\n          state.pointerPos.x = ev.pageX - offset.left;\n          state.pointerPos.y = ev.pageY - offset.top;\n\n          // Move tooltip\n          state.toolTipElem.style.top = \"\".concat(state.pointerPos.y, \"px\");\n          state.toolTipElem.style.left = \"\".concat(state.pointerPos.x, \"px\");\n          // adjust horizontal position to not exceed canvas boundaries\n          state.toolTipElem.style.transform = \"translate(-\".concat(state.pointerPos.x / state.width * 100, \"%, \").concat(\n          // flip to above if near bottom\n          state.height - state.pointerPos.y < 100 ? 'calc(-100% - 8px)' : '21px', \")\");\n        }\n        function getOffset(el) {\n          var rect = el.getBoundingClientRect(),\n            scrollLeft = window.pageXOffset || document.documentElement.scrollLeft,\n            scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n          return {\n            top: rect.top + scrollTop,\n            left: rect.left + scrollLeft\n          };\n        }\n      }, {\n        passive: true\n      });\n    });\n\n    // Handle click events on objs\n    state.container.addEventListener('pointerup', function (ev) {\n      state.isPointerPressed = false;\n      if (state.isPointerDragging) {\n        state.isPointerDragging = false;\n        if (!state.clickAfterDrag) return; // don't trigger onClick after pointer drag (camera motion via controls)\n      }\n      requestAnimationFrame(function () {\n        // trigger click events asynchronously, to allow hoverObj to be set (on frame)\n        if (ev.button === 0) {\n          // left-click\n          state.onClick(state.hoverObj || null, ev, state.intersectionPoint); // trigger background clicks with null\n        }\n        if (ev.button === 2 && state.onRightClick) {\n          // right-click\n          state.onRightClick(state.hoverObj || null, ev, state.intersectionPoint);\n        }\n      });\n    }, {\n      passive: true,\n      capture: true\n    }); // use capture phase to prevent propagation blocking from controls (specifically for fly)\n\n    state.container.addEventListener('contextmenu', function (ev) {\n      if (state.onRightClick) ev.preventDefault(); // prevent default contextmenu behavior and allow pointerup to fire instead\n    });\n\n    // Setup renderer, camera and controls\n    state.renderer = new three.WebGLRenderer(Object.assign({\n      antialias: true,\n      alpha: true\n    }, rendererConfig));\n    state.renderer.setPixelRatio(Math.min(2, window.devicePixelRatio)); // clamp device pixel ratio\n    state.container.appendChild(state.renderer.domElement);\n\n    // Setup extra renderers\n    state.extraRenderers = extraRenderers;\n    state.extraRenderers.forEach(function (r) {\n      // overlay them on top of main renderer\n      r.domElement.style.position = 'absolute';\n      r.domElement.style.top = '0px';\n      r.domElement.style.pointerEvents = 'none';\n      state.container.appendChild(r.domElement);\n    });\n\n    // configure post-processing composer\n    state.postProcessingComposer = new three_examples_jsm_postprocessing_EffectComposer_js__WEBPACK_IMPORTED_MODULE_4__.EffectComposer(state.renderer);\n    state.postProcessingComposer.addPass(new three_examples_jsm_postprocessing_RenderPass_js__WEBPACK_IMPORTED_MODULE_5__.RenderPass(state.scene, state.camera)); // render scene as first pass\n\n    // configure controls\n    state.controls = new {\n      trackball: three_examples_jsm_controls_TrackballControls_js__WEBPACK_IMPORTED_MODULE_6__.TrackballControls,\n      orbit: three_examples_jsm_controls_OrbitControls_js__WEBPACK_IMPORTED_MODULE_7__.OrbitControls,\n      fly: three_examples_jsm_controls_FlyControls_js__WEBPACK_IMPORTED_MODULE_8__.FlyControls\n    }[controlType](state.camera, state.renderer.domElement);\n    if (controlType === 'fly') {\n      state.controls.movementSpeed = 300;\n      state.controls.rollSpeed = Math.PI / 6;\n      state.controls.dragToLook = true;\n    }\n    if (controlType === 'trackball' || controlType === 'orbit') {\n      state.controls.minDistance = 0.1;\n      state.controls.maxDistance = state.skyRadius;\n      state.controls.addEventListener('start', function () {\n        state.controlsEngaged = true;\n      });\n      state.controls.addEventListener('change', function () {\n        if (state.controlsEngaged) {\n          state.controlsDragging = true;\n        }\n      });\n      state.controls.addEventListener('end', function () {\n        state.controlsEngaged = false;\n        state.controlsDragging = false;\n      });\n    }\n    [state.renderer, state.postProcessingComposer].concat(_toConsumableArray(state.extraRenderers)).forEach(function (r) {\n      return r.setSize(state.width, state.height);\n    });\n    state.camera.aspect = state.width / state.height;\n    state.camera.updateProjectionMatrix();\n    state.camera.position.z = 1000;\n\n    // add sky\n    state.scene.add(state.skysphere = new three.Mesh());\n    state.skysphere.visible = false;\n    state.loadComplete = state.scene.visible = !waitForLoadComplete;\n    window.scene = state.scene;\n  },\n  update: function update(state, changedProps) {\n    // resize canvas\n    if (state.width && state.height && (changedProps.hasOwnProperty('width') || changedProps.hasOwnProperty('height'))) {\n      state.container.style.width = \"\".concat(state.width, \"px\");\n      state.container.style.height = \"\".concat(state.height, \"px\");\n      [state.renderer, state.postProcessingComposer].concat(_toConsumableArray(state.extraRenderers)).forEach(function (r) {\n        return r.setSize(state.width, state.height);\n      });\n      state.camera.aspect = state.width / state.height;\n      state.camera.updateProjectionMatrix();\n    }\n    if (changedProps.hasOwnProperty('skyRadius') && state.skyRadius) {\n      state.controls.hasOwnProperty('maxDistance') && changedProps.skyRadius && (state.controls.maxDistance = Math.min(state.controls.maxDistance, state.skyRadius));\n      state.camera.far = state.skyRadius * 2.5;\n      state.camera.updateProjectionMatrix();\n      state.skysphere.geometry = new three.SphereGeometry(state.skyRadius);\n    }\n    if (changedProps.hasOwnProperty('backgroundColor')) {\n      var alpha = (0,polished__WEBPACK_IMPORTED_MODULE_9__.parseToRgb)(state.backgroundColor).alpha;\n      if (alpha === undefined) alpha = 1;\n      state.renderer.setClearColor(new three.Color((0,polished__WEBPACK_IMPORTED_MODULE_9__.opacify)(1, state.backgroundColor)), alpha);\n    }\n    if (changedProps.hasOwnProperty('backgroundImageUrl')) {\n      if (!state.backgroundImageUrl) {\n        state.skysphere.visible = false;\n        state.skysphere.material.map = null;\n        !state.loadComplete && finishLoad();\n      } else {\n        new three.TextureLoader().load(state.backgroundImageUrl, function (texture) {\n          texture.colorSpace = three.SRGBColorSpace;\n          state.skysphere.material = new three.MeshBasicMaterial({\n            map: texture,\n            side: three.BackSide\n          });\n          state.skysphere.visible = true;\n\n          // triggered when background image finishes loading (asynchronously to allow 1 frame to load texture)\n          state.onBackgroundImageLoaded && setTimeout(state.onBackgroundImageLoaded);\n          !state.loadComplete && finishLoad();\n        });\n      }\n    }\n    changedProps.hasOwnProperty('showNavInfo') && (state.navInfo.style.display = state.showNavInfo ? null : 'none');\n    if (changedProps.hasOwnProperty('lights')) {\n      (changedProps.lights || []).forEach(function (light) {\n        return state.scene.remove(light);\n      }); // Clear the place\n      state.lights.forEach(function (light) {\n        return state.scene.add(light);\n      }); // Add to scene\n    }\n    if (changedProps.hasOwnProperty('objects')) {\n      (changedProps.objects || []).forEach(function (obj) {\n        return state.scene.remove(obj);\n      }); // Clear the place\n      state.objects.forEach(function (obj) {\n        return state.scene.add(obj);\n      }); // Add to scene\n    }\n\n    //\n\n    function finishLoad() {\n      state.loadComplete = state.scene.visible = true;\n    }\n  }\n});\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWUtcmVuZGVyLW9iamVjdHNAMS4yOS40X3RocmVlQDAuMTY3LjEvbm9kZV9tb2R1bGVzL3RocmVlLXJlbmRlci1vYmplY3RzL2Rpc3QvdGhyZWUtcmVuZGVyLW9iamVjdHMubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQWtQO0FBQzdKO0FBQ1I7QUFDSjtBQUNZO0FBQ1I7QUFDOUI7QUFDSjtBQUNOO0FBQ1A7O0FBRTlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBLGlDQUFpQyxnQkFBZ0IsZ0JBQWdCLHVCQUF1QixxQkFBcUIsaUJBQWlCLG9CQUFvQixHQUFHLG9CQUFvQixXQUFXLG9CQUFvQixvQkFBb0IsR0FBRyxxQ0FBcUMsdUJBQXVCLDRCQUE0Qix5QkFBeUIsc0JBQXNCLEdBQUcsbUNBQW1DLGtCQUFrQixHQUFHO0FBQ2phOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsWUFBWSxrRUFBa0U7QUFDN0gsTUFBTTtBQUNOO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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Vjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRXdDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc21hX3Bvc3Rfc2NhcmNpdHkvLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWUtcmVuZGVyLW9iamVjdHNAMS4yOS40X3RocmVlQDAuMTY3LjEvbm9kZV9tb2R1bGVzL3RocmVlLXJlbmRlci1vYmplY3RzL2Rpc3QvdGhyZWUtcmVuZGVyLW9iamVjdHMubWpzP2Q5YmYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgV2ViR0xSZW5kZXJlciwgU2NlbmUsIFBlcnNwZWN0aXZlQ2FtZXJhLCBSYXljYXN0ZXIsIFNSR0JDb2xvclNwYWNlLCBUZXh0dXJlTG9hZGVyLCBWZWN0b3IyLCBWZWN0b3IzLCBCb3gzLCBDb2xvciwgTWVzaCwgU3BoZXJlR2VvbWV0cnksIE1lc2hCYXNpY01hdGVyaWFsLCBCYWNrU2lkZSwgRXZlbnREaXNwYXRjaGVyLCBNT1VTRSwgUXVhdGVybmlvbiwgU3BoZXJpY2FsLCBDbG9jayB9IGZyb20gJ3RocmVlJztcbmltcG9ydCB7IFRyYWNrYmFsbENvbnRyb2xzIH0gZnJvbSAndGhyZWUvZXhhbXBsZXMvanNtL2NvbnRyb2xzL1RyYWNrYmFsbENvbnRyb2xzLmpzJztcbmltcG9ydCB7IE9yYml0Q29udHJvbHMgfSBmcm9tICd0aHJlZS9leGFtcGxlcy9qc20vY29udHJvbHMvT3JiaXRDb250cm9scy5qcyc7XG5pbXBvcnQgeyBGbHlDb250cm9scyB9IGZyb20gJ3RocmVlL2V4YW1wbGVzL2pzbS9jb250cm9scy9GbHlDb250cm9scy5qcyc7XG5pbXBvcnQgeyBFZmZlY3RDb21wb3NlciB9IGZyb20gJ3RocmVlL2V4YW1wbGVzL2pzbS9wb3N0cHJvY2Vzc2luZy9FZmZlY3RDb21wb3Nlci5qcyc7XG5pbXBvcnQgeyBSZW5kZXJQYXNzIH0gZnJvbSAndGhyZWUvZXhhbXBsZXMvanNtL3Bvc3Rwcm9jZXNzaW5nL1JlbmRlclBhc3MuanMnO1xuaW1wb3J0IHsgcGFyc2VUb1JnYiwgb3BhY2lmeSB9IGZyb20gJ3BvbGlzaGVkJztcbmltcG9ydCAqIGFzIFRXRUVOIGZyb20gJ0B0d2VlbmpzL3R3ZWVuLmpzJztcbmltcG9ydCBhY2Nlc3NvckZuIGZyb20gJ2FjY2Vzc29yLWZuJztcbmltcG9ydCBLYXBzdWxlIGZyb20gJ2thcHN1bGUnO1xuXG5mdW5jdGlvbiBzdHlsZUluamVjdChjc3MsIHJlZikge1xuICByZWYgPSB7fTtcbiAgcmVmLmluc2VydEF0O1xuICBpZiAodHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybjtcbiAgfVxuICB2YXIgaGVhZCA9IGRvY3VtZW50LmhlYWQgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXTtcbiAgdmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgc3R5bGUudHlwZSA9ICd0ZXh0L2Nzcyc7XG4gIHtcbiAgICBoZWFkLmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgfVxuICBpZiAoc3R5bGUuc3R5bGVTaGVldCkge1xuICAgIHN0eWxlLnN0eWxlU2hlZXQuY3NzVGV4dCA9IGNzcztcbiAgfSBlbHNlIHtcbiAgICBzdHlsZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjc3MpKTtcbiAgfVxufVxuXG52YXIgY3NzXzI0OHogPSBcIi5zY2VuZS1uYXYtaW5mbyB7XFxuICBib3R0b206IDVweDtcXG4gIHdpZHRoOiAxMDAlO1xcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xcbiAgY29sb3I6IHNsYXRlZ3JleTtcXG4gIG9wYWNpdHk6IDAuNztcXG4gIGZvbnQtc2l6ZTogMTBweDtcXG59XFxuXFxuLnNjZW5lLXRvb2x0aXAge1xcbiAgdG9wOiAwO1xcbiAgY29sb3I6IGxhdmVuZGVyO1xcbiAgZm9udC1zaXplOiAxNXB4O1xcbn1cXG5cXG4uc2NlbmUtbmF2LWluZm8sIC5zY2VuZS10b29sdGlwIHtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIGZvbnQtZmFtaWx5OiBzYW5zLXNlcmlmO1xcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XFxuICB1c2VyLXNlbGVjdDogbm9uZTtcXG59XFxuXFxuLnNjZW5lLWNvbnRhaW5lciBjYW52YXM6Zm9jdXMge1xcbiAgb3V0bGluZTogbm9uZTtcXG59XCI7XG5zdHlsZUluamVjdChjc3NfMjQ4eik7XG5cbmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChyLCBsKSB7XG4gIHZhciB0ID0gbnVsbCA9PSByID8gbnVsbCA6IFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIFN5bWJvbCAmJiByW1N5bWJvbC5pdGVyYXRvcl0gfHwgcltcIkBAaXRlcmF0b3JcIl07XG4gIGlmIChudWxsICE9IHQpIHtcbiAgICB2YXIgZSxcbiAgICAgIG4sXG4gICAgICBpLFxuICAgICAgdSxcbiAgICAgIGEgPSBbXSxcbiAgICAgIGYgPSAhMCxcbiAgICAgIG8gPSAhMTtcbiAgICB0cnkge1xuICAgICAgaWYgKGkgPSAodCA9IHQuY2FsbChyKSkubmV4dCwgMCA9PT0gbCkgOyBlbHNlIGZvciAoOyAhKGYgPSAoZSA9IGkuY2FsbCh0KSkuZG9uZSkgJiYgKGEucHVzaChlLnZhbHVlKSwgYS5sZW5ndGggIT09IGwpOyBmID0gITApO1xuICAgIH0gY2F0Y2ggKHIpIHtcbiAgICAgIG8gPSAhMCwgbiA9IHI7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmICghZiAmJiBudWxsICE9IHQucmV0dXJuICYmICh1ID0gdC5yZXR1cm4oKSwgT2JqZWN0KHUpICE9PSB1KSkgcmV0dXJuO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgaWYgKG8pIHRocm93IG47XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhO1xuICB9XG59XG5mdW5jdGlvbiBfdG9QcmltaXRpdmUodCwgcikge1xuICBpZiAoXCJvYmplY3RcIiAhPSB0eXBlb2YgdCB8fCAhdCkgcmV0dXJuIHQ7XG4gIHZhciBlID0gdFtTeW1ib2wudG9QcmltaXRpdmVdO1xuICBpZiAodm9pZCAwICE9PSBlKSB7XG4gICAgdmFyIGkgPSBlLmNhbGwodCwgciApO1xuICAgIGlmIChcIm9iamVjdFwiICE9IHR5cGVvZiBpKSByZXR1cm4gaTtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS5cIik7XG4gIH1cbiAgcmV0dXJuIChTdHJpbmcgKSh0KTtcbn1cbmZ1bmN0aW9uIF90b1Byb3BlcnR5S2V5KHQpIHtcbiAgdmFyIGkgPSBfdG9QcmltaXRpdmUodCwgXCJzdHJpbmdcIik7XG4gIHJldHVybiBcInN5bWJvbFwiID09IHR5cGVvZiBpID8gaSA6IGkgKyBcIlwiO1xufVxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkge1xuICBrZXkgPSBfdG9Qcm9wZXJ0eUtleShrZXkpO1xuICBpZiAoa2V5IGluIG9iaikge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwge1xuICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlXG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgb2JqW2tleV0gPSB2YWx1ZTtcbiAgfVxuICByZXR1cm4gb2JqO1xufVxuZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7XG4gIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7XG59XG5mdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7XG4gIHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7XG59XG5mdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShhcnIpO1xufVxuZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikge1xuICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyO1xufVxuZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7XG4gIGlmICh0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIGl0ZXJbU3ltYm9sLml0ZXJhdG9yXSAhPSBudWxsIHx8IGl0ZXJbXCJAQGl0ZXJhdG9yXCJdICE9IG51bGwpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpO1xufVxuZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikge1xuICBpZiAoIW8pIHJldHVybjtcbiAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTtcbiAgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpO1xuICBpZiAobiA9PT0gXCJPYmplY3RcIiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lO1xuICBpZiAobiA9PT0gXCJNYXBcIiB8fCBuID09PSBcIlNldFwiKSByZXR1cm4gQXJyYXkuZnJvbShvKTtcbiAgaWYgKG4gPT09IFwiQXJndW1lbnRzXCIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pO1xufVxuZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHtcbiAgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7XG4gIGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgYXJyMltpXSA9IGFycltpXTtcbiAgcmV0dXJuIGFycjI7XG59XG5mdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpO1xufVxuZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHtcbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTtcbn1cblxudmFyIHRocmVlID0gd2luZG93LlRIUkVFID8gd2luZG93LlRIUkVFIC8vIFByZWZlciBjb25zdW1wdGlvbiBmcm9tIGdsb2JhbCBUSFJFRSwgaWYgZXhpc3RzXG46IHtcbiAgV2ViR0xSZW5kZXJlcjogV2ViR0xSZW5kZXJlcixcbiAgU2NlbmU6IFNjZW5lLFxuICBQZXJzcGVjdGl2ZUNhbWVyYTogUGVyc3BlY3RpdmVDYW1lcmEsXG4gIFJheWNhc3RlcjogUmF5Y2FzdGVyLFxuICBTUkdCQ29sb3JTcGFjZTogU1JHQkNvbG9yU3BhY2UsXG4gIFRleHR1cmVMb2FkZXI6IFRleHR1cmVMb2FkZXIsXG4gIFZlY3RvcjI6IFZlY3RvcjIsXG4gIFZlY3RvcjM6IFZlY3RvcjMsXG4gIEJveDM6IEJveDMsXG4gIENvbG9yOiBDb2xvcixcbiAgTWVzaDogTWVzaCxcbiAgU3BoZXJlR2VvbWV0cnk6IFNwaGVyZUdlb21ldHJ5LFxuICBNZXNoQmFzaWNNYXRlcmlhbDogTWVzaEJhc2ljTWF0ZXJpYWwsXG4gIEJhY2tTaWRlOiBCYWNrU2lkZSxcbiAgRXZlbnREaXNwYXRjaGVyOiBFdmVudERpc3BhdGNoZXIsXG4gIE1PVVNFOiBNT1VTRSxcbiAgUXVhdGVybmlvbjogUXVhdGVybmlvbixcbiAgU3BoZXJpY2FsOiBTcGhlcmljYWwsXG4gIENsb2NrOiBDbG9ja1xufTtcbnZhciB0aHJlZVJlbmRlck9iamVjdHMgPSBLYXBzdWxlKHtcbiAgcHJvcHM6IHtcbiAgICB3aWR0aDoge1xuICAgICAgXCJkZWZhdWx0XCI6IHdpbmRvdy5pbm5lcldpZHRoLFxuICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKHdpZHRoLCBzdGF0ZSwgcHJldldpZHRoKSB7XG4gICAgICAgIGlzTmFOKHdpZHRoKSAmJiAoc3RhdGUud2lkdGggPSBwcmV2V2lkdGgpO1xuICAgICAgfVxuICAgIH0sXG4gICAgaGVpZ2h0OiB7XG4gICAgICBcImRlZmF1bHRcIjogd2luZG93LmlubmVySGVpZ2h0LFxuICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGhlaWdodCwgc3RhdGUsIHByZXZIZWlnaHQpIHtcbiAgICAgICAgaXNOYU4oaGVpZ2h0KSAmJiAoc3RhdGUuaGVpZ2h0ID0gcHJldkhlaWdodCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBiYWNrZ3JvdW5kQ29sb3I6IHtcbiAgICAgIFwiZGVmYXVsdFwiOiAnIzAwMDAxMSdcbiAgICB9LFxuICAgIGJhY2tncm91bmRJbWFnZVVybDoge30sXG4gICAgb25CYWNrZ3JvdW5kSW1hZ2VMb2FkZWQ6IHt9LFxuICAgIHNob3dOYXZJbmZvOiB7XG4gICAgICBcImRlZmF1bHRcIjogdHJ1ZVxuICAgIH0sXG4gICAgc2t5UmFkaXVzOiB7XG4gICAgICBcImRlZmF1bHRcIjogNTAwMDBcbiAgICB9LFxuICAgIG9iamVjdHM6IHtcbiAgICAgIFwiZGVmYXVsdFwiOiBbXVxuICAgIH0sXG4gICAgbGlnaHRzOiB7XG4gICAgICBcImRlZmF1bHRcIjogW11cbiAgICB9LFxuICAgIGVuYWJsZVBvaW50ZXJJbnRlcmFjdGlvbjoge1xuICAgICAgXCJkZWZhdWx0XCI6IHRydWUsXG4gICAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UoXywgc3RhdGUpIHtcbiAgICAgICAgLy8gUmVzZXQgaG92ZXIgc3RhdGVcbiAgICAgICAgc3RhdGUuaG92ZXJPYmogPSBudWxsO1xuICAgICAgICBpZiAoc3RhdGUudG9vbFRpcEVsZW0pIHN0YXRlLnRvb2xUaXBFbGVtLmlubmVySFRNTCA9ICcnO1xuICAgICAgfSxcbiAgICAgIHRyaWdnZXJVcGRhdGU6IGZhbHNlXG4gICAgfSxcbiAgICBsaW5lSG92ZXJQcmVjaXNpb246IHtcbiAgICAgIFwiZGVmYXVsdFwiOiAxLFxuICAgICAgdHJpZ2dlclVwZGF0ZTogZmFsc2VcbiAgICB9LFxuICAgIGhvdmVyT3JkZXJDb21wYXJhdG9yOiB7XG4gICAgICBcImRlZmF1bHRcIjogZnVuY3Rpb24gX2RlZmF1bHQoKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICAgIH0sXG4gICAgICB0cmlnZ2VyVXBkYXRlOiBmYWxzZVxuICAgIH0sXG4gICAgLy8ga2VlcCBleGlzdGluZyBvcmRlciBieSBkZWZhdWx0XG4gICAgaG92ZXJGaWx0ZXI6IHtcbiAgICAgIFwiZGVmYXVsdFwiOiBmdW5jdGlvbiBfZGVmYXVsdCgpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9LFxuICAgICAgdHJpZ2dlclVwZGF0ZTogZmFsc2VcbiAgICB9LFxuICAgIC8vIGV4Y2x1ZGUgb2JqZWN0cyBmcm9tIGludGVyYWN0aW9uXG4gICAgdG9vbHRpcENvbnRlbnQ6IHtcbiAgICAgIHRyaWdnZXJVcGRhdGU6IGZhbHNlXG4gICAgfSxcbiAgICBob3ZlckR1cmluZ0RyYWc6IHtcbiAgICAgIFwiZGVmYXVsdFwiOiBmYWxzZSxcbiAgICAgIHRyaWdnZXJVcGRhdGU6IGZhbHNlXG4gICAgfSxcbiAgICBjbGlja0FmdGVyRHJhZzoge1xuICAgICAgXCJkZWZhdWx0XCI6IGZhbHNlLFxuICAgICAgdHJpZ2dlclVwZGF0ZTogZmFsc2VcbiAgICB9LFxuICAgIG9uSG92ZXI6IHtcbiAgICAgIFwiZGVmYXVsdFwiOiBmdW5jdGlvbiBfZGVmYXVsdCgpIHt9LFxuICAgICAgdHJpZ2dlclVwZGF0ZTogZmFsc2VcbiAgICB9LFxuICAgIG9uQ2xpY2s6IHtcbiAgICAgIFwiZGVmYXVsdFwiOiBmdW5jdGlvbiBfZGVmYXVsdCgpIHt9LFxuICAgICAgdHJpZ2dlclVwZGF0ZTogZmFsc2VcbiAgICB9LFxuICAgIG9uUmlnaHRDbGljazoge1xuICAgICAgdHJpZ2dlclVwZGF0ZTogZmFsc2VcbiAgICB9XG4gIH0sXG4gIG1ldGhvZHM6IHtcbiAgICB0aWNrOiBmdW5jdGlvbiB0aWNrKHN0YXRlKSB7XG4gICAgICBpZiAoc3RhdGUuaW5pdGlhbGlzZWQpIHtcbiAgICAgICAgc3RhdGUuY29udHJvbHMudXBkYXRlICYmIHN0YXRlLmNvbnRyb2xzLnVwZGF0ZShNYXRoLm1pbigxLCBzdGF0ZS5jbG9jay5nZXREZWx0YSgpKSk7IC8vIHRpbWVkZWx0YSBpcyByZXF1aXJlZCBmb3IgZmx5IGNvbnRyb2xzXG5cbiAgICAgICAgc3RhdGUucG9zdFByb2Nlc3NpbmdDb21wb3NlciA/IHN0YXRlLnBvc3RQcm9jZXNzaW5nQ29tcG9zZXIucmVuZGVyKCkgLy8gaWYgdXNpbmcgcG9zdHByb2Nlc3NpbmcsIHN3aXRjaCB0aGUgb3V0cHV0IHRvIGl0XG4gICAgICAgIDogc3RhdGUucmVuZGVyZXIucmVuZGVyKHN0YXRlLnNjZW5lLCBzdGF0ZS5jYW1lcmEpO1xuICAgICAgICBzdGF0ZS5leHRyYVJlbmRlcmVycy5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7XG4gICAgICAgICAgcmV0dXJuIHIucmVuZGVyKHN0YXRlLnNjZW5lLCBzdGF0ZS5jYW1lcmEpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHN0YXRlLmVuYWJsZVBvaW50ZXJJbnRlcmFjdGlvbikge1xuICAgICAgICAgIC8vIFVwZGF0ZSB0b29sdGlwIGFuZCB0cmlnZ2VyIG9uSG92ZXIgZXZlbnRzXG4gICAgICAgICAgdmFyIHRvcE9iamVjdCA9IG51bGw7XG4gICAgICAgICAgaWYgKHN0YXRlLmhvdmVyRHVyaW5nRHJhZyB8fCAhc3RhdGUuaXNQb2ludGVyRHJhZ2dpbmcpIHtcbiAgICAgICAgICAgIHZhciBpbnRlcnNlY3RzID0gdGhpcy5pbnRlcnNlY3RpbmdPYmplY3RzKHN0YXRlLnBvaW50ZXJQb3MueCwgc3RhdGUucG9pbnRlclBvcy55KS5maWx0ZXIoZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHN0YXRlLmhvdmVyRmlsdGVyKGQub2JqZWN0KTtcbiAgICAgICAgICAgIH0pLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHN0YXRlLmhvdmVyT3JkZXJDb21wYXJhdG9yKGEub2JqZWN0LCBiLm9iamVjdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciB0b3BJbnRlcnNlY3QgPSBpbnRlcnNlY3RzLmxlbmd0aCA/IGludGVyc2VjdHNbMF0gOiBudWxsO1xuICAgICAgICAgICAgdG9wT2JqZWN0ID0gdG9wSW50ZXJzZWN0ID8gdG9wSW50ZXJzZWN0Lm9iamVjdCA6IG51bGw7XG4gICAgICAgICAgICBzdGF0ZS5pbnRlcnNlY3Rpb25Qb2ludCA9IHRvcEludGVyc2VjdCA/IHRvcEludGVyc2VjdC5wb2ludCA6IG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0b3BPYmplY3QgIT09IHN0YXRlLmhvdmVyT2JqKSB7XG4gICAgICAgICAgICBzdGF0ZS5vbkhvdmVyKHRvcE9iamVjdCwgc3RhdGUuaG92ZXJPYmopO1xuICAgICAgICAgICAgc3RhdGUudG9vbFRpcEVsZW0uaW5uZXJIVE1MID0gdG9wT2JqZWN0ID8gYWNjZXNzb3JGbihzdGF0ZS50b29sdGlwQ29udGVudCkodG9wT2JqZWN0KSB8fCAnJyA6ICcnO1xuICAgICAgICAgICAgc3RhdGUuaG92ZXJPYmogPSB0b3BPYmplY3Q7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFRXRUVOLnVwZGF0ZSgpOyAvLyB1cGRhdGUgY2FtZXJhIGFuaW1hdGlvbiB0d2VlbnNcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgZ2V0UG9pbnRlclBvczogZnVuY3Rpb24gZ2V0UG9pbnRlclBvcyhzdGF0ZSkge1xuICAgICAgdmFyIF9zdGF0ZSRwb2ludGVyUG9zID0gc3RhdGUucG9pbnRlclBvcyxcbiAgICAgICAgeCA9IF9zdGF0ZSRwb2ludGVyUG9zLngsXG4gICAgICAgIHkgPSBfc3RhdGUkcG9pbnRlclBvcy55O1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgeDogeCxcbiAgICAgICAgeTogeVxuICAgICAgfTtcbiAgICB9LFxuICAgIGNhbWVyYVBvc2l0aW9uOiBmdW5jdGlvbiBjYW1lcmFQb3NpdGlvbihzdGF0ZSwgcG9zaXRpb24sIGxvb2tBdCwgdHJhbnNpdGlvbkR1cmF0aW9uKSB7XG4gICAgICB2YXIgY2FtZXJhID0gc3RhdGUuY2FtZXJhO1xuXG4gICAgICAvLyBTZXR0ZXJcbiAgICAgIGlmIChwb3NpdGlvbiAmJiBzdGF0ZS5pbml0aWFsaXNlZCkge1xuICAgICAgICB2YXIgZmluYWxQb3MgPSBwb3NpdGlvbjtcbiAgICAgICAgdmFyIGZpbmFsTG9va0F0ID0gbG9va0F0IHx8IHtcbiAgICAgICAgICB4OiAwLFxuICAgICAgICAgIHk6IDAsXG4gICAgICAgICAgejogMFxuICAgICAgICB9O1xuICAgICAgICBpZiAoIXRyYW5zaXRpb25EdXJhdGlvbikge1xuICAgICAgICAgIC8vIG5vIGFuaW1hdGlvblxuICAgICAgICAgIHNldENhbWVyYVBvcyhmaW5hbFBvcyk7XG4gICAgICAgICAgc2V0TG9va0F0KGZpbmFsTG9va0F0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgY2FtUG9zID0gT2JqZWN0LmFzc2lnbih7fSwgY2FtZXJhLnBvc2l0aW9uKTtcbiAgICAgICAgICB2YXIgY2FtTG9va0F0ID0gZ2V0TG9va0F0KCk7XG4gICAgICAgICAgbmV3IFRXRUVOLlR3ZWVuKGNhbVBvcykudG8oZmluYWxQb3MsIHRyYW5zaXRpb25EdXJhdGlvbikuZWFzaW5nKFRXRUVOLkVhc2luZy5RdWFkcmF0aWMuT3V0KS5vblVwZGF0ZShzZXRDYW1lcmFQb3MpLnN0YXJ0KCk7XG5cbiAgICAgICAgICAvLyBGYWNlIGRpcmVjdGlvbiBpbiAxLzNyZCBvZiB0aW1lXG4gICAgICAgICAgbmV3IFRXRUVOLlR3ZWVuKGNhbUxvb2tBdCkudG8oZmluYWxMb29rQXQsIHRyYW5zaXRpb25EdXJhdGlvbiAvIDMpLmVhc2luZyhUV0VFTi5FYXNpbmcuUXVhZHJhdGljLk91dCkub25VcGRhdGUoc2V0TG9va0F0KS5zdGFydCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICAvLyBHZXR0ZXJcbiAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBjYW1lcmEucG9zaXRpb24sIHtcbiAgICAgICAgbG9va0F0OiBnZXRMb29rQXQoKVxuICAgICAgfSk7XG5cbiAgICAgIC8vXG5cbiAgICAgIGZ1bmN0aW9uIHNldENhbWVyYVBvcyhwb3MpIHtcbiAgICAgICAgdmFyIHggPSBwb3MueCxcbiAgICAgICAgICB5ID0gcG9zLnksXG4gICAgICAgICAgeiA9IHBvcy56O1xuICAgICAgICBpZiAoeCAhPT0gdW5kZWZpbmVkKSBjYW1lcmEucG9zaXRpb24ueCA9IHg7XG4gICAgICAgIGlmICh5ICE9PSB1bmRlZmluZWQpIGNhbWVyYS5wb3NpdGlvbi55ID0geTtcbiAgICAgICAgaWYgKHogIT09IHVuZGVmaW5lZCkgY2FtZXJhLnBvc2l0aW9uLnogPSB6O1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gc2V0TG9va0F0KGxvb2tBdCkge1xuICAgICAgICB2YXIgbG9va0F0VmVjdCA9IG5ldyB0aHJlZS5WZWN0b3IzKGxvb2tBdC54LCBsb29rQXQueSwgbG9va0F0LnopO1xuICAgICAgICBpZiAoc3RhdGUuY29udHJvbHMudGFyZ2V0KSB7XG4gICAgICAgICAgc3RhdGUuY29udHJvbHMudGFyZ2V0ID0gbG9va0F0VmVjdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBGbHkgY29udHJvbHMgZG9lc24ndCBoYXZlIHRhcmdldCBhdHRyaWJ1dGVcbiAgICAgICAgICBjYW1lcmEubG9va0F0KGxvb2tBdFZlY3QpOyAvLyBub3RlOiBsb29rQXQgbWF5IGJlIG92ZXJyaWRkZW4gYnkgb3RoZXIgY29udHJvbHMgaW4gc29tZSBjYXNlc1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBnZXRMb29rQXQoKSB7XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKG5ldyB0aHJlZS5WZWN0b3IzKDAsIDAsIC0xMDAwKS5hcHBseVF1YXRlcm5pb24oY2FtZXJhLnF1YXRlcm5pb24pLmFkZChjYW1lcmEucG9zaXRpb24pKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHpvb21Ub0ZpdDogZnVuY3Rpb24gem9vbVRvRml0KHN0YXRlKSB7XG4gICAgICB2YXIgdHJhbnNpdGlvbkR1cmF0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAwO1xuICAgICAgdmFyIHBhZGRpbmcgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IDEwO1xuICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGJib3hBcmdzID0gbmV3IEFycmF5KF9sZW4gPiAzID8gX2xlbiAtIDMgOiAwKSwgX2tleSA9IDM7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgICAgYmJveEFyZ3NbX2tleSAtIDNdID0gYXJndW1lbnRzW19rZXldO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuZml0VG9CYm94KHRoaXMuZ2V0QmJveC5hcHBseSh0aGlzLCBiYm94QXJncyksIHRyYW5zaXRpb25EdXJhdGlvbiwgcGFkZGluZyk7XG4gICAgfSxcbiAgICBmaXRUb0Jib3g6IGZ1bmN0aW9uIGZpdFRvQmJveChzdGF0ZSwgYmJveCkge1xuICAgICAgdmFyIHRyYW5zaXRpb25EdXJhdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogMDtcbiAgICAgIHZhciBwYWRkaW5nID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiAxMDtcbiAgICAgIC8vIGJhc2VkIG9uIGh0dHBzOi8vZGlzY291cnNlLnRocmVlanMub3JnL3QvY2FtZXJhLXpvb20tdG8tZml0LW9iamVjdC85MzYvMjRcbiAgICAgIHZhciBjYW1lcmEgPSBzdGF0ZS5jYW1lcmE7XG4gICAgICBpZiAoYmJveCkge1xuICAgICAgICB2YXIgY2VudGVyID0gbmV3IHRocmVlLlZlY3RvcjMoMCwgMCwgMCk7IC8vIHJlc2V0IGNhbWVyYSBhaW0gdG8gY2VudGVyXG4gICAgICAgIHZhciBtYXhCb3hTaWRlID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgX3RvQ29uc3VtYWJsZUFycmF5KE9iamVjdC5lbnRyaWVzKGJib3gpLm1hcChmdW5jdGlvbiAoX3JlZikge1xuICAgICAgICAgIHZhciBfcmVmMiA9IF9zbGljZWRUb0FycmF5KF9yZWYsIDIpLFxuICAgICAgICAgICAgY29vcmRUeXBlID0gX3JlZjJbMF0sXG4gICAgICAgICAgICBjb29yZHMgPSBfcmVmMlsxXTtcbiAgICAgICAgICByZXR1cm4gTWF0aC5tYXguYXBwbHkoTWF0aCwgX3RvQ29uc3VtYWJsZUFycmF5KGNvb3Jkcy5tYXAoZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmFicyhjZW50ZXJbY29vcmRUeXBlXSAtIGMpO1xuICAgICAgICAgIH0pKSk7XG4gICAgICAgIH0pKSkgKiAyO1xuXG4gICAgICAgIC8vIGZpbmQgZGlzdGFuY2UgdGhhdCBmaXRzIHdob2xlIGJib3ggd2l0aGluIHBhZGRlZCBmb3ZcbiAgICAgICAgdmFyIHBhZGRlZEZvdiA9ICgxIC0gcGFkZGluZyAqIDIgLyBzdGF0ZS5oZWlnaHQpICogY2FtZXJhLmZvdjtcbiAgICAgICAgdmFyIGZpdEhlaWdodERpc3RhbmNlID0gbWF4Qm94U2lkZSAvIE1hdGguYXRhbihwYWRkZWRGb3YgKiBNYXRoLlBJIC8gMTgwKTtcbiAgICAgICAgdmFyIGZpdFdpZHRoRGlzdGFuY2UgPSBmaXRIZWlnaHREaXN0YW5jZSAvIGNhbWVyYS5hc3BlY3Q7XG4gICAgICAgIHZhciBkaXN0YW5jZSA9IE1hdGgubWF4KGZpdEhlaWdodERpc3RhbmNlLCBmaXRXaWR0aERpc3RhbmNlKTtcbiAgICAgICAgaWYgKGRpc3RhbmNlID4gMCkge1xuICAgICAgICAgIHZhciBuZXdDYW1lcmFQb3NpdGlvbiA9IGNlbnRlci5jbG9uZSgpLnN1YihjYW1lcmEucG9zaXRpb24pLm5vcm1hbGl6ZSgpLm11bHRpcGx5U2NhbGFyKC1kaXN0YW5jZSk7XG4gICAgICAgICAgdGhpcy5jYW1lcmFQb3NpdGlvbihuZXdDYW1lcmFQb3NpdGlvbiwgY2VudGVyLCB0cmFuc2l0aW9uRHVyYXRpb24pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuICAgIGdldEJib3g6IGZ1bmN0aW9uIGdldEJib3goc3RhdGUpIHtcbiAgICAgIHZhciBvYmpGaWx0ZXIgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuICAgICAgdmFyIGJveCA9IG5ldyB0aHJlZS5Cb3gzKG5ldyB0aHJlZS5WZWN0b3IzKDAsIDAsIDApLCBuZXcgdGhyZWUuVmVjdG9yMygwLCAwLCAwKSk7XG4gICAgICB2YXIgb2JqcyA9IHN0YXRlLm9iamVjdHMuZmlsdGVyKG9iakZpbHRlcik7XG4gICAgICBpZiAoIW9ianMubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAgIG9ianMuZm9yRWFjaChmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgIHJldHVybiBib3guZXhwYW5kQnlPYmplY3Qob2JqKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBleHRyYWN0IGdsb2JhbCB4LHkseiBtaW4vbWF4XG4gICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbi5hcHBseShPYmplY3QsIF90b0NvbnN1bWFibGVBcnJheShbJ3gnLCAneScsICd6J10ubWFwKGZ1bmN0aW9uIChjKSB7XG4gICAgICAgIHJldHVybiBfZGVmaW5lUHJvcGVydHkoe30sIGMsIFtib3gubWluW2NdLCBib3gubWF4W2NdXSk7XG4gICAgICB9KSkpO1xuICAgIH0sXG4gICAgZ2V0U2NyZWVuQ29vcmRzOiBmdW5jdGlvbiBnZXRTY3JlZW5Db29yZHMoc3RhdGUsIHgsIHksIHopIHtcbiAgICAgIHZhciB2ZWMgPSBuZXcgdGhyZWUuVmVjdG9yMyh4LCB5LCB6KTtcbiAgICAgIHZlYy5wcm9qZWN0KHRoaXMuY2FtZXJhKCkpOyAvLyBwcm9qZWN0IHRvIHRoZSBjYW1lcmEgcGxhbmVcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC8vIGFsaWduIHJlbGF0aXZlIHBvcyB0byBjYW52YXMgZGltZW5zaW9uc1xuICAgICAgICB4OiAodmVjLnggKyAxKSAqIHN0YXRlLndpZHRoIC8gMixcbiAgICAgICAgeTogLSh2ZWMueSAtIDEpICogc3RhdGUuaGVpZ2h0IC8gMlxuICAgICAgfTtcbiAgICB9LFxuICAgIGdldFNjZW5lQ29vcmRzOiBmdW5jdGlvbiBnZXRTY2VuZUNvb3JkcyhzdGF0ZSwgc2NyZWVuWCwgc2NyZWVuWSkge1xuICAgICAgdmFyIGRpc3RhbmNlID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiAwO1xuICAgICAgdmFyIHJlbENvb3JkcyA9IG5ldyB0aHJlZS5WZWN0b3IyKHNjcmVlblggLyBzdGF0ZS53aWR0aCAqIDIgLSAxLCAtKHNjcmVlblkgLyBzdGF0ZS5oZWlnaHQpICogMiArIDEpO1xuICAgICAgdmFyIHJheWNhc3RlciA9IG5ldyB0aHJlZS5SYXljYXN0ZXIoKTtcbiAgICAgIHJheWNhc3Rlci5zZXRGcm9tQ2FtZXJhKHJlbENvb3Jkcywgc3RhdGUuY2FtZXJhKTtcbiAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCByYXljYXN0ZXIucmF5LmF0KGRpc3RhbmNlLCBuZXcgdGhyZWUuVmVjdG9yMygpKSk7XG4gICAgfSxcbiAgICBpbnRlcnNlY3RpbmdPYmplY3RzOiBmdW5jdGlvbiBpbnRlcnNlY3RpbmdPYmplY3RzKHN0YXRlLCB4LCB5KSB7XG4gICAgICB2YXIgcmVsQ29vcmRzID0gbmV3IHRocmVlLlZlY3RvcjIoeCAvIHN0YXRlLndpZHRoICogMiAtIDEsIC0oeSAvIHN0YXRlLmhlaWdodCkgKiAyICsgMSk7XG4gICAgICB2YXIgcmF5Y2FzdGVyID0gbmV3IHRocmVlLlJheWNhc3RlcigpO1xuICAgICAgcmF5Y2FzdGVyLnBhcmFtcy5MaW5lLnRocmVzaG9sZCA9IHN0YXRlLmxpbmVIb3ZlclByZWNpc2lvbjsgLy8gc2V0IGxpbmVQcmVjaXNpb25cbiAgICAgIHJheWNhc3Rlci5zZXRGcm9tQ2FtZXJhKHJlbENvb3Jkcywgc3RhdGUuY2FtZXJhKTtcbiAgICAgIHJldHVybiByYXljYXN0ZXIuaW50ZXJzZWN0T2JqZWN0cyhzdGF0ZS5vYmplY3RzLCB0cnVlKTtcbiAgICB9LFxuICAgIHJlbmRlcmVyOiBmdW5jdGlvbiByZW5kZXJlcihzdGF0ZSkge1xuICAgICAgcmV0dXJuIHN0YXRlLnJlbmRlcmVyO1xuICAgIH0sXG4gICAgc2NlbmU6IGZ1bmN0aW9uIHNjZW5lKHN0YXRlKSB7XG4gICAgICByZXR1cm4gc3RhdGUuc2NlbmU7XG4gICAgfSxcbiAgICBjYW1lcmE6IGZ1bmN0aW9uIGNhbWVyYShzdGF0ZSkge1xuICAgICAgcmV0dXJuIHN0YXRlLmNhbWVyYTtcbiAgICB9LFxuICAgIHBvc3RQcm9jZXNzaW5nQ29tcG9zZXI6IGZ1bmN0aW9uIHBvc3RQcm9jZXNzaW5nQ29tcG9zZXIoc3RhdGUpIHtcbiAgICAgIHJldHVybiBzdGF0ZS5wb3N0UHJvY2Vzc2luZ0NvbXBvc2VyO1xuICAgIH0sXG4gICAgY29udHJvbHM6IGZ1bmN0aW9uIGNvbnRyb2xzKHN0YXRlKSB7XG4gICAgICByZXR1cm4gc3RhdGUuY29udHJvbHM7XG4gICAgfSxcbiAgICB0YkNvbnRyb2xzOiBmdW5jdGlvbiB0YkNvbnRyb2xzKHN0YXRlKSB7XG4gICAgICByZXR1cm4gc3RhdGUuY29udHJvbHM7XG4gICAgfSAvLyB0byBiZSBkZXByZWNhdGVkXG4gIH0sXG4gIHN0YXRlSW5pdDogZnVuY3Rpb24gc3RhdGVJbml0KCkge1xuICAgIHJldHVybiB7XG4gICAgICBzY2VuZTogbmV3IHRocmVlLlNjZW5lKCksXG4gICAgICBjYW1lcmE6IG5ldyB0aHJlZS5QZXJzcGVjdGl2ZUNhbWVyYSgpLFxuICAgICAgY2xvY2s6IG5ldyB0aHJlZS5DbG9jaygpXG4gICAgfTtcbiAgfSxcbiAgaW5pdDogZnVuY3Rpb24gaW5pdChkb21Ob2RlLCBzdGF0ZSkge1xuICAgIHZhciBfcmVmNCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge30sXG4gICAgICBfcmVmNCRjb250cm9sVHlwZSA9IF9yZWY0LmNvbnRyb2xUeXBlLFxuICAgICAgY29udHJvbFR5cGUgPSBfcmVmNCRjb250cm9sVHlwZSA9PT0gdm9pZCAwID8gJ3RyYWNrYmFsbCcgOiBfcmVmNCRjb250cm9sVHlwZSxcbiAgICAgIF9yZWY0JHJlbmRlcmVyQ29uZmlnID0gX3JlZjQucmVuZGVyZXJDb25maWcsXG4gICAgICByZW5kZXJlckNvbmZpZyA9IF9yZWY0JHJlbmRlcmVyQ29uZmlnID09PSB2b2lkIDAgPyB7fSA6IF9yZWY0JHJlbmRlcmVyQ29uZmlnLFxuICAgICAgX3JlZjQkZXh0cmFSZW5kZXJlcnMgPSBfcmVmNC5leHRyYVJlbmRlcmVycyxcbiAgICAgIGV4dHJhUmVuZGVyZXJzID0gX3JlZjQkZXh0cmFSZW5kZXJlcnMgPT09IHZvaWQgMCA/IFtdIDogX3JlZjQkZXh0cmFSZW5kZXJlcnMsXG4gICAgICBfcmVmNCR3YWl0Rm9yTG9hZENvbXAgPSBfcmVmNC53YWl0Rm9yTG9hZENvbXBsZXRlLFxuICAgICAgd2FpdEZvckxvYWRDb21wbGV0ZSA9IF9yZWY0JHdhaXRGb3JMb2FkQ29tcCA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9yZWY0JHdhaXRGb3JMb2FkQ29tcDtcbiAgICAvLyBXaXBlIERPTVxuICAgIGRvbU5vZGUuaW5uZXJIVE1MID0gJyc7XG5cbiAgICAvLyBBZGQgcmVsYXRpdmUgY29udGFpbmVyXG4gICAgZG9tTm9kZS5hcHBlbmRDaGlsZChzdGF0ZS5jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSk7XG4gICAgc3RhdGUuY29udGFpbmVyLmNsYXNzTmFtZSA9ICdzY2VuZS1jb250YWluZXInO1xuICAgIHN0YXRlLmNvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG5cbiAgICAvLyBBZGQgbmF2IGluZm8gc2VjdGlvblxuICAgIHN0YXRlLmNvbnRhaW5lci5hcHBlbmRDaGlsZChzdGF0ZS5uYXZJbmZvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykpO1xuICAgIHN0YXRlLm5hdkluZm8uY2xhc3NOYW1lID0gJ3NjZW5lLW5hdi1pbmZvJztcbiAgICBzdGF0ZS5uYXZJbmZvLnRleHRDb250ZW50ID0ge1xuICAgICAgb3JiaXQ6ICdMZWZ0LWNsaWNrOiByb3RhdGUsIE1vdXNlLXdoZWVsL21pZGRsZS1jbGljazogem9vbSwgUmlnaHQtY2xpY2s6IHBhbicsXG4gICAgICB0cmFja2JhbGw6ICdMZWZ0LWNsaWNrOiByb3RhdGUsIE1vdXNlLXdoZWVsL21pZGRsZS1jbGljazogem9vbSwgUmlnaHQtY2xpY2s6IHBhbicsXG4gICAgICBmbHk6ICdXQVNEOiBtb3ZlLCBSfEY6IHVwIHwgZG93biwgUXxFOiByb2xsLCB1cHxkb3duOiBwaXRjaCwgbGVmdHxyaWdodDogeWF3J1xuICAgIH1bY29udHJvbFR5cGVdIHx8ICcnO1xuICAgIHN0YXRlLm5hdkluZm8uc3R5bGUuZGlzcGxheSA9IHN0YXRlLnNob3dOYXZJbmZvID8gbnVsbCA6ICdub25lJztcblxuICAgIC8vIFNldHVwIHRvb2x0aXBcbiAgICBzdGF0ZS50b29sVGlwRWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHN0YXRlLnRvb2xUaXBFbGVtLmNsYXNzTGlzdC5hZGQoJ3NjZW5lLXRvb2x0aXAnKTtcbiAgICBzdGF0ZS5jb250YWluZXIuYXBwZW5kQ2hpbGQoc3RhdGUudG9vbFRpcEVsZW0pO1xuXG4gICAgLy8gQ2FwdHVyZSBwb2ludGVyIGNvb3JkcyBvbiBtb3ZlIG9yIHRvdWNoc3RhcnRcbiAgICBzdGF0ZS5wb2ludGVyUG9zID0gbmV3IHRocmVlLlZlY3RvcjIoKTtcbiAgICBzdGF0ZS5wb2ludGVyUG9zLnggPSAtMjsgLy8gSW5pdGlhbGl6ZSBvZmYgY2FudmFzXG4gICAgc3RhdGUucG9pbnRlclBvcy55ID0gLTI7XG4gICAgWydwb2ludGVybW92ZScsICdwb2ludGVyZG93biddLmZvckVhY2goZnVuY3Rpb24gKGV2VHlwZSkge1xuICAgICAgcmV0dXJuIHN0YXRlLmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKGV2VHlwZSwgZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgIC8vIHRyYWNrIGNsaWNrIHN0YXRlXG4gICAgICAgIGV2VHlwZSA9PT0gJ3BvaW50ZXJkb3duJyAmJiAoc3RhdGUuaXNQb2ludGVyUHJlc3NlZCA9IHRydWUpO1xuXG4gICAgICAgIC8vIGRldGVjdCBwb2ludCBkcmFnXG4gICAgICAgICFzdGF0ZS5pc1BvaW50ZXJEcmFnZ2luZyAmJiBldi50eXBlID09PSAncG9pbnRlcm1vdmUnICYmIChldi5wcmVzc3VyZSA+IDAgfHwgc3RhdGUuaXNQb2ludGVyUHJlc3NlZCkgLy8gZXYucHJlc3N1cmUgYWx3YXlzIDAgb24gU2FmYXJpLCBzbyB3ZSB1c2VkIHRoZSBpc1BvaW50ZXJQcmVzc2VkIHRyYWNrZXJcbiAgICAgICAgJiYgKGV2LnBvaW50ZXJUeXBlICE9PSAndG91Y2gnIHx8IGV2Lm1vdmVtZW50WCA9PT0gdW5kZWZpbmVkIHx8IFtldi5tb3ZlbWVudFgsIGV2Lm1vdmVtZW50WV0uc29tZShmdW5jdGlvbiAobSkge1xuICAgICAgICAgIHJldHVybiBNYXRoLmFicyhtKSA+IDE7XG4gICAgICAgIH0pKSAvLyByZWxheCBkcmFnIHRyaWdnZXIgc2Vuc2l0aXZpdHkgb24gdG91Y2ggZXZlbnRzXG4gICAgICAgICYmIChzdGF0ZS5pc1BvaW50ZXJEcmFnZ2luZyA9IHRydWUpO1xuICAgICAgICBpZiAoc3RhdGUuZW5hYmxlUG9pbnRlckludGVyYWN0aW9uKSB7XG4gICAgICAgICAgLy8gdXBkYXRlIHRoZSBwb2ludGVyIHBvc1xuICAgICAgICAgIHZhciBvZmZzZXQgPSBnZXRPZmZzZXQoc3RhdGUuY29udGFpbmVyKTtcbiAgICAgICAgICBzdGF0ZS5wb2ludGVyUG9zLnggPSBldi5wYWdlWCAtIG9mZnNldC5sZWZ0O1xuICAgICAgICAgIHN0YXRlLnBvaW50ZXJQb3MueSA9IGV2LnBhZ2VZIC0gb2Zmc2V0LnRvcDtcblxuICAgICAgICAgIC8vIE1vdmUgdG9vbHRpcFxuICAgICAgICAgIHN0YXRlLnRvb2xUaXBFbGVtLnN0eWxlLnRvcCA9IFwiXCIuY29uY2F0KHN0YXRlLnBvaW50ZXJQb3MueSwgXCJweFwiKTtcbiAgICAgICAgICBzdGF0ZS50b29sVGlwRWxlbS5zdHlsZS5sZWZ0ID0gXCJcIi5jb25jYXQoc3RhdGUucG9pbnRlclBvcy54LCBcInB4XCIpO1xuICAgICAgICAgIC8vIGFkanVzdCBob3Jpem9udGFsIHBvc2l0aW9uIHRvIG5vdCBleGNlZWQgY2FudmFzIGJvdW5kYXJpZXNcbiAgICAgICAgICBzdGF0ZS50b29sVGlwRWxlbS5zdHlsZS50cmFuc2Zvcm0gPSBcInRyYW5zbGF0ZSgtXCIuY29uY2F0KHN0YXRlLnBvaW50ZXJQb3MueCAvIHN0YXRlLndpZHRoICogMTAwLCBcIiUsIFwiKS5jb25jYXQoXG4gICAgICAgICAgLy8gZmxpcCB0byBhYm92ZSBpZiBuZWFyIGJvdHRvbVxuICAgICAgICAgIHN0YXRlLmhlaWdodCAtIHN0YXRlLnBvaW50ZXJQb3MueSA8IDEwMCA/ICdjYWxjKC0xMDAlIC0gOHB4KScgOiAnMjFweCcsIFwiKVwiKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRPZmZzZXQoZWwpIHtcbiAgICAgICAgICB2YXIgcmVjdCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgICAgc2Nyb2xsTGVmdCA9IHdpbmRvdy5wYWdlWE9mZnNldCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdCxcbiAgICAgICAgICAgIHNjcm9sbFRvcCA9IHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0b3A6IHJlY3QudG9wICsgc2Nyb2xsVG9wLFxuICAgICAgICAgICAgbGVmdDogcmVjdC5sZWZ0ICsgc2Nyb2xsTGVmdFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH0sIHtcbiAgICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBIYW5kbGUgY2xpY2sgZXZlbnRzIG9uIG9ianNcbiAgICBzdGF0ZS5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcnVwJywgZnVuY3Rpb24gKGV2KSB7XG4gICAgICBzdGF0ZS5pc1BvaW50ZXJQcmVzc2VkID0gZmFsc2U7XG4gICAgICBpZiAoc3RhdGUuaXNQb2ludGVyRHJhZ2dpbmcpIHtcbiAgICAgICAgc3RhdGUuaXNQb2ludGVyRHJhZ2dpbmcgPSBmYWxzZTtcbiAgICAgICAgaWYgKCFzdGF0ZS5jbGlja0FmdGVyRHJhZykgcmV0dXJuOyAvLyBkb24ndCB0cmlnZ2VyIG9uQ2xpY2sgYWZ0ZXIgcG9pbnRlciBkcmFnIChjYW1lcmEgbW90aW9uIHZpYSBjb250cm9scylcbiAgICAgIH1cbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIHRyaWdnZXIgY2xpY2sgZXZlbnRzIGFzeW5jaHJvbm91c2x5LCB0byBhbGxvdyBob3Zlck9iaiB0byBiZSBzZXQgKG9uIGZyYW1lKVxuICAgICAgICBpZiAoZXYuYnV0dG9uID09PSAwKSB7XG4gICAgICAgICAgLy8gbGVmdC1jbGlja1xuICAgICAgICAgIHN0YXRlLm9uQ2xpY2soc3RhdGUuaG92ZXJPYmogfHwgbnVsbCwgZXYsIHN0YXRlLmludGVyc2VjdGlvblBvaW50KTsgLy8gdHJpZ2dlciBiYWNrZ3JvdW5kIGNsaWNrcyB3aXRoIG51bGxcbiAgICAgICAgfVxuICAgICAgICBpZiAoZXYuYnV0dG9uID09PSAyICYmIHN0YXRlLm9uUmlnaHRDbGljaykge1xuICAgICAgICAgIC8vIHJpZ2h0LWNsaWNrXG4gICAgICAgICAgc3RhdGUub25SaWdodENsaWNrKHN0YXRlLmhvdmVyT2JqIHx8IG51bGwsIGV2LCBzdGF0ZS5pbnRlcnNlY3Rpb25Qb2ludCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sIHtcbiAgICAgIHBhc3NpdmU6IHRydWUsXG4gICAgICBjYXB0dXJlOiB0cnVlXG4gICAgfSk7IC8vIHVzZSBjYXB0dXJlIHBoYXNlIHRvIHByZXZlbnQgcHJvcGFnYXRpb24gYmxvY2tpbmcgZnJvbSBjb250cm9scyAoc3BlY2lmaWNhbGx5IGZvciBmbHkpXG5cbiAgICBzdGF0ZS5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY29udGV4dG1lbnUnLCBmdW5jdGlvbiAoZXYpIHtcbiAgICAgIGlmIChzdGF0ZS5vblJpZ2h0Q2xpY2spIGV2LnByZXZlbnREZWZhdWx0KCk7IC8vIHByZXZlbnQgZGVmYXVsdCBjb250ZXh0bWVudSBiZWhhdmlvciBhbmQgYWxsb3cgcG9pbnRlcnVwIHRvIGZpcmUgaW5zdGVhZFxuICAgIH0pO1xuXG4gICAgLy8gU2V0dXAgcmVuZGVyZXIsIGNhbWVyYSBhbmQgY29udHJvbHNcbiAgICBzdGF0ZS5yZW5kZXJlciA9IG5ldyB0aHJlZS5XZWJHTFJlbmRlcmVyKE9iamVjdC5hc3NpZ24oe1xuICAgICAgYW50aWFsaWFzOiB0cnVlLFxuICAgICAgYWxwaGE6IHRydWVcbiAgICB9LCByZW5kZXJlckNvbmZpZykpO1xuICAgIHN0YXRlLnJlbmRlcmVyLnNldFBpeGVsUmF0aW8oTWF0aC5taW4oMiwgd2luZG93LmRldmljZVBpeGVsUmF0aW8pKTsgLy8gY2xhbXAgZGV2aWNlIHBpeGVsIHJhdGlvXG4gICAgc3RhdGUuY29udGFpbmVyLmFwcGVuZENoaWxkKHN0YXRlLnJlbmRlcmVyLmRvbUVsZW1lbnQpO1xuXG4gICAgLy8gU2V0dXAgZXh0cmEgcmVuZGVyZXJzXG4gICAgc3RhdGUuZXh0cmFSZW5kZXJlcnMgPSBleHRyYVJlbmRlcmVycztcbiAgICBzdGF0ZS5leHRyYVJlbmRlcmVycy5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7XG4gICAgICAvLyBvdmVybGF5IHRoZW0gb24gdG9wIG9mIG1haW4gcmVuZGVyZXJcbiAgICAgIHIuZG9tRWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICByLmRvbUVsZW1lbnQuc3R5bGUudG9wID0gJzBweCc7XG4gICAgICByLmRvbUVsZW1lbnQuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJztcbiAgICAgIHN0YXRlLmNvbnRhaW5lci5hcHBlbmRDaGlsZChyLmRvbUVsZW1lbnQpO1xuICAgIH0pO1xuXG4gICAgLy8gY29uZmlndXJlIHBvc3QtcHJvY2Vzc2luZyBjb21wb3NlclxuICAgIHN0YXRlLnBvc3RQcm9jZXNzaW5nQ29tcG9zZXIgPSBuZXcgRWZmZWN0Q29tcG9zZXIoc3RhdGUucmVuZGVyZXIpO1xuICAgIHN0YXRlLnBvc3RQcm9jZXNzaW5nQ29tcG9zZXIuYWRkUGFzcyhuZXcgUmVuZGVyUGFzcyhzdGF0ZS5zY2VuZSwgc3RhdGUuY2FtZXJhKSk7IC8vIHJlbmRlciBzY2VuZSBhcyBmaXJzdCBwYXNzXG5cbiAgICAvLyBjb25maWd1cmUgY29udHJvbHNcbiAgICBzdGF0ZS5jb250cm9scyA9IG5ldyB7XG4gICAgICB0cmFja2JhbGw6IFRyYWNrYmFsbENvbnRyb2xzLFxuICAgICAgb3JiaXQ6IE9yYml0Q29udHJvbHMsXG4gICAgICBmbHk6IEZseUNvbnRyb2xzXG4gICAgfVtjb250cm9sVHlwZV0oc3RhdGUuY2FtZXJhLCBzdGF0ZS5yZW5kZXJlci5kb21FbGVtZW50KTtcbiAgICBpZiAoY29udHJvbFR5cGUgPT09ICdmbHknKSB7XG4gICAgICBzdGF0ZS5jb250cm9scy5tb3ZlbWVudFNwZWVkID0gMzAwO1xuICAgICAgc3RhdGUuY29udHJvbHMucm9sbFNwZWVkID0gTWF0aC5QSSAvIDY7XG4gICAgICBzdGF0ZS5jb250cm9scy5kcmFnVG9Mb29rID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKGNvbnRyb2xUeXBlID09PSAndHJhY2tiYWxsJyB8fCBjb250cm9sVHlwZSA9PT0gJ29yYml0Jykge1xuICAgICAgc3RhdGUuY29udHJvbHMubWluRGlzdGFuY2UgPSAwLjE7XG4gICAgICBzdGF0ZS5jb250cm9scy5tYXhEaXN0YW5jZSA9IHN0YXRlLnNreVJhZGl1cztcbiAgICAgIHN0YXRlLmNvbnRyb2xzLmFkZEV2ZW50TGlzdGVuZXIoJ3N0YXJ0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICBzdGF0ZS5jb250cm9sc0VuZ2FnZWQgPSB0cnVlO1xuICAgICAgfSk7XG4gICAgICBzdGF0ZS5jb250cm9scy5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChzdGF0ZS5jb250cm9sc0VuZ2FnZWQpIHtcbiAgICAgICAgICBzdGF0ZS5jb250cm9sc0RyYWdnaW5nID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBzdGF0ZS5jb250cm9scy5hZGRFdmVudExpc3RlbmVyKCdlbmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHN0YXRlLmNvbnRyb2xzRW5nYWdlZCA9IGZhbHNlO1xuICAgICAgICBzdGF0ZS5jb250cm9sc0RyYWdnaW5nID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9XG4gICAgW3N0YXRlLnJlbmRlcmVyLCBzdGF0ZS5wb3N0UHJvY2Vzc2luZ0NvbXBvc2VyXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHN0YXRlLmV4dHJhUmVuZGVyZXJzKSkuZm9yRWFjaChmdW5jdGlvbiAocikge1xuICAgICAgcmV0dXJuIHIuc2V0U2l6ZShzdGF0ZS53aWR0aCwgc3RhdGUuaGVpZ2h0KTtcbiAgICB9KTtcbiAgICBzdGF0ZS5jYW1lcmEuYXNwZWN0ID0gc3RhdGUud2lkdGggLyBzdGF0ZS5oZWlnaHQ7XG4gICAgc3RhdGUuY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTtcbiAgICBzdGF0ZS5jYW1lcmEucG9zaXRpb24ueiA9IDEwMDA7XG5cbiAgICAvLyBhZGQgc2t5XG4gICAgc3RhdGUuc2NlbmUuYWRkKHN0YXRlLnNreXNwaGVyZSA9IG5ldyB0aHJlZS5NZXNoKCkpO1xuICAgIHN0YXRlLnNreXNwaGVyZS52aXNpYmxlID0gZmFsc2U7XG4gICAgc3RhdGUubG9hZENvbXBsZXRlID0gc3RhdGUuc2NlbmUudmlzaWJsZSA9ICF3YWl0Rm9yTG9hZENvbXBsZXRlO1xuICAgIHdpbmRvdy5zY2VuZSA9IHN0YXRlLnNjZW5lO1xuICB9LFxuICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZShzdGF0ZSwgY2hhbmdlZFByb3BzKSB7XG4gICAgLy8gcmVzaXplIGNhbnZhc1xuICAgIGlmIChzdGF0ZS53aWR0aCAmJiBzdGF0ZS5oZWlnaHQgJiYgKGNoYW5nZWRQcm9wcy5oYXNPd25Qcm9wZXJ0eSgnd2lkdGgnKSB8fCBjaGFuZ2VkUHJvcHMuaGFzT3duUHJvcGVydHkoJ2hlaWdodCcpKSkge1xuICAgICAgc3RhdGUuY29udGFpbmVyLnN0eWxlLndpZHRoID0gXCJcIi5jb25jYXQoc3RhdGUud2lkdGgsIFwicHhcIik7XG4gICAgICBzdGF0ZS5jb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gXCJcIi5jb25jYXQoc3RhdGUuaGVpZ2h0LCBcInB4XCIpO1xuICAgICAgW3N0YXRlLnJlbmRlcmVyLCBzdGF0ZS5wb3N0UHJvY2Vzc2luZ0NvbXBvc2VyXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHN0YXRlLmV4dHJhUmVuZGVyZXJzKSkuZm9yRWFjaChmdW5jdGlvbiAocikge1xuICAgICAgICByZXR1cm4gci5zZXRTaXplKHN0YXRlLndpZHRoLCBzdGF0ZS5oZWlnaHQpO1xuICAgICAgfSk7XG4gICAgICBzdGF0ZS5jYW1lcmEuYXNwZWN0ID0gc3RhdGUud2lkdGggLyBzdGF0ZS5oZWlnaHQ7XG4gICAgICBzdGF0ZS5jYW1lcmEudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpO1xuICAgIH1cbiAgICBpZiAoY2hhbmdlZFByb3BzLmhhc093blByb3BlcnR5KCdza3lSYWRpdXMnKSAmJiBzdGF0ZS5za3lSYWRpdXMpIHtcbiAgICAgIHN0YXRlLmNvbnRyb2xzLmhhc093blByb3BlcnR5KCdtYXhEaXN0YW5jZScpICYmIGNoYW5nZWRQcm9wcy5za3lSYWRpdXMgJiYgKHN0YXRlLmNvbnRyb2xzLm1heERpc3RhbmNlID0gTWF0aC5taW4oc3RhdGUuY29udHJvbHMubWF4RGlzdGFuY2UsIHN0YXRlLnNreVJhZGl1cykpO1xuICAgICAgc3RhdGUuY2FtZXJhLmZhciA9IHN0YXRlLnNreVJhZGl1cyAqIDIuNTtcbiAgICAgIHN0YXRlLmNhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG4gICAgICBzdGF0ZS5za3lzcGhlcmUuZ2VvbWV0cnkgPSBuZXcgdGhyZWUuU3BoZXJlR2VvbWV0cnkoc3RhdGUuc2t5UmFkaXVzKTtcbiAgICB9XG4gICAgaWYgKGNoYW5nZWRQcm9wcy5oYXNPd25Qcm9wZXJ0eSgnYmFja2dyb3VuZENvbG9yJykpIHtcbiAgICAgIHZhciBhbHBoYSA9IHBhcnNlVG9SZ2Ioc3RhdGUuYmFja2dyb3VuZENvbG9yKS5hbHBoYTtcbiAgICAgIGlmIChhbHBoYSA9PT0gdW5kZWZpbmVkKSBhbHBoYSA9IDE7XG4gICAgICBzdGF0ZS5yZW5kZXJlci5zZXRDbGVhckNvbG9yKG5ldyB0aHJlZS5Db2xvcihvcGFjaWZ5KDEsIHN0YXRlLmJhY2tncm91bmRDb2xvcikpLCBhbHBoYSk7XG4gICAgfVxuICAgIGlmIChjaGFuZ2VkUHJvcHMuaGFzT3duUHJvcGVydHkoJ2JhY2tncm91bmRJbWFnZVVybCcpKSB7XG4gICAgICBpZiAoIXN0YXRlLmJhY2tncm91bmRJbWFnZVVybCkge1xuICAgICAgICBzdGF0ZS5za3lzcGhlcmUudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICBzdGF0ZS5za3lzcGhlcmUubWF0ZXJpYWwubWFwID0gbnVsbDtcbiAgICAgICAgIXN0YXRlLmxvYWRDb21wbGV0ZSAmJiBmaW5pc2hMb2FkKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXcgdGhyZWUuVGV4dHVyZUxvYWRlcigpLmxvYWQoc3RhdGUuYmFja2dyb3VuZEltYWdlVXJsLCBmdW5jdGlvbiAodGV4dHVyZSkge1xuICAgICAgICAgIHRleHR1cmUuY29sb3JTcGFjZSA9IHRocmVlLlNSR0JDb2xvclNwYWNlO1xuICAgICAgICAgIHN0YXRlLnNreXNwaGVyZS5tYXRlcmlhbCA9IG5ldyB0aHJlZS5NZXNoQmFzaWNNYXRlcmlhbCh7XG4gICAgICAgICAgICBtYXA6IHRleHR1cmUsXG4gICAgICAgICAgICBzaWRlOiB0aHJlZS5CYWNrU2lkZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHN0YXRlLnNreXNwaGVyZS52aXNpYmxlID0gdHJ1ZTtcblxuICAgICAgICAgIC8vIHRyaWdnZXJlZCB3aGVuIGJhY2tncm91bmQgaW1hZ2UgZmluaXNoZXMgbG9hZGluZyAoYXN5bmNocm9ub3VzbHkgdG8gYWxsb3cgMSBmcmFtZSB0byBsb2FkIHRleHR1cmUpXG4gICAgICAgICAgc3RhdGUub25CYWNrZ3JvdW5kSW1hZ2VMb2FkZWQgJiYgc2V0VGltZW91dChzdGF0ZS5vbkJhY2tncm91bmRJbWFnZUxvYWRlZCk7XG4gICAgICAgICAgIXN0YXRlLmxvYWRDb21wbGV0ZSAmJiBmaW5pc2hMb2FkKCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBjaGFuZ2VkUHJvcHMuaGFzT3duUHJvcGVydHkoJ3Nob3dOYXZJbmZvJykgJiYgKHN0YXRlLm5hdkluZm8uc3R5bGUuZGlzcGxheSA9IHN0YXRlLnNob3dOYXZJbmZvID8gbnVsbCA6ICdub25lJyk7XG4gICAgaWYgKGNoYW5nZWRQcm9wcy5oYXNPd25Qcm9wZXJ0eSgnbGlnaHRzJykpIHtcbiAgICAgIChjaGFuZ2VkUHJvcHMubGlnaHRzIHx8IFtdKS5mb3JFYWNoKGZ1bmN0aW9uIChsaWdodCkge1xuICAgICAgICByZXR1cm4gc3RhdGUuc2NlbmUucmVtb3ZlKGxpZ2h0KTtcbiAgICAgIH0pOyAvLyBDbGVhciB0aGUgcGxhY2VcbiAgICAgIHN0YXRlLmxpZ2h0cy5mb3JFYWNoKGZ1bmN0aW9uIChsaWdodCkge1xuICAgICAgICByZXR1cm4gc3RhdGUuc2NlbmUuYWRkKGxpZ2h0KTtcbiAgICAgIH0pOyAvLyBBZGQgdG8gc2NlbmVcbiAgICB9XG4gICAgaWYgKGNoYW5nZWRQcm9wcy5oYXNPd25Qcm9wZXJ0eSgnb2JqZWN0cycpKSB7XG4gICAgICAoY2hhbmdlZFByb3BzLm9iamVjdHMgfHwgW10pLmZvckVhY2goZnVuY3Rpb24gKG9iaikge1xuICAgICAgICByZXR1cm4gc3RhdGUuc2NlbmUucmVtb3ZlKG9iaik7XG4gICAgICB9KTsgLy8gQ2xlYXIgdGhlIHBsYWNlXG4gICAgICBzdGF0ZS5vYmplY3RzLmZvckVhY2goZnVuY3Rpb24gKG9iaikge1xuICAgICAgICByZXR1cm4gc3RhdGUuc2NlbmUuYWRkKG9iaik7XG4gICAgICB9KTsgLy8gQWRkIHRvIHNjZW5lXG4gICAgfVxuXG4gICAgLy9cblxuICAgIGZ1bmN0aW9uIGZpbmlzaExvYWQoKSB7XG4gICAgICBzdGF0ZS5sb2FkQ29tcGxldGUgPSBzdGF0ZS5zY2VuZS52aXNpYmxlID0gdHJ1ZTtcbiAgICB9XG4gIH1cbn0pO1xuXG5leHBvcnQgeyB0aHJlZVJlbmRlck9iamVjdHMgYXMgZGVmYXVsdCB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/three-render-objects@1.29.4_three@0.167.1/node_modules/three-render-objects/dist/three-render-objects.mjs\n");

/***/ })

};
;